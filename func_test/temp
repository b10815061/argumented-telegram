from quart import Blueprint, ResponseReturnValue, request
from telethon import TelegramClient
from telethon.tl.functions.account import GetGlobalPrivacySettingsRequest
import route.util as utils
import telethon

blueprint = Blueprint("setting", __name__)

async def find_user(client_list, userID) -> TelegramClient:
    if userID in client_list:
        return client_list[userID]
    else:
        return None

@blueprint.get("/getglobalpri/<userID>")
async def index(userID) -> ResponseReturnValue:
    print(utils.client_list)
    print(userID)
    user: TelegramClient = await find_user(utils.client_list, userID)
    print(user)
    print("start")
    result = await user(GetGlobalPrivacySettingsRequest())
    print(result.stringify())
    return result.stringify(), 200